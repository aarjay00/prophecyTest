{"textPassword":null,"refreshKrb5Config":null,"keytab":null,"format":"jdbc","cascadeTruncate":null,"secretPassword":[{"type":"pipelineConfiguration","value":["password_aka_alxaa2_Query_sel_2772"]}],"lowerBound":null,"writeMode":"read","description":"","preSQL":"","customSchema":null,"postSQL":"","partitionColumn":null,"pushDownPredicate":true,"truncate":null,"batchsize":null,"query":"select\n\tm.mbr_indv_be_key \"Member BE Key\",\n\tsp.mbr_indv_be_key \"Household Member BE Key\",\n\trcst.prod_sh_nm \"Member Product\",\n\tsp.prod_sh_nm \"Household Member Prod\",\n\trcst.actvty_yr_mo_sk,\n\tsp.retiree_in_household_in\n\nfrom\n\tprod.mbr_d m\n\tinner join\n\t\tprod.mbr_rcst_ct_f rcst on rcst.mbr_sk = m.mbr_sk\n\tinner join\n\t\tprod.yr_mo_d yr_mo on yr_mo.yr_mo_sk = rcst.actvty_yr_mo_sk\n\tinner join\n\t\tprod.mbr_enr_d e on e.mbr_sk = rcst.mbr_sk\n\tinner join\n\t\t(\n\t\t\tselect\n\t\t\t\tm.mbr_indv_be_key,\n\t\t\t\tm.mbr_home_addr_ln_1,\n\t\t\t\tm.mbr_home_addr_ln_2,\n\t\t\t\tm.mbr_home_addr_cnty_nm,\n\t\t\t\tm.mbr_home_addr_st_cd,\n\t\t\t\trcst.prod_sh_nm,\n\t\t\t\trcst.actvty_yr_mo_sk,\n\t\t\t\t1 as retiree_in_household_in\n\n\t\t\tfrom\n\t\t\t\tprod.mbr_d m\n\t\t\t\tinner join\n\t\t\t\t\tprod.mbr_rcst_ct_f rcst on rcst.mbr_sk = m.mbr_sk\n\t\t\t\tinner join\n\t\t\t\t\tprod.mbr_enr_d e on e.mbr_sk = rcst.mbr_sk\n\t\t\t\tinner join\n\t\t\t\t\tprod.yr_mo_d yr_mo on yr_mo.yr_mo_sk = rcst.actvty_yr_mo_sk\n\n\t\t\twhere\n\t\t\t\trcst.prod_sh_nm in ('BMADVP','BMADVH','MEDGAP','MEDSEL','TIP','CBLU65')\n\t\t\t\tand m.mbr_indv_be_key <> 0\n\t\t\t\tand yr_mo.first_dt_of_mo > char(current date - 49 month, iso)\n\t\t\t\tand yr_mo.first_dt_of_mo < char(current date - 1 month, iso)\n\t\t\t\tand rcst.mbr_age_at_actvty_yr_mo >= 65\n\t\t\t\tand e.MBR_ENR_CLS_PLN_PROD_CAT_CD = 'MED'\n\t\t) sp on sp.actvty_yr_mo_sk = rcst.actvty_yr_mo_sk and sp.MBR_HOME_ADDR_LN_1 = m.MBR_HOME_ADDR_LN_1 and sp.mbr_home_addr_cnty_nm = m.mbr_home_addr_cnty_nm and sp.mbr_home_addr_st_cd = m.mbr_home_addr_st_cd and sp.mbr_home_addr_ln_2 = m.mbr_home_addr_ln_2\n\nwhere\n\tm.mbr_indv_be_key <> 0\n\tand rcst.prod_sh_nm not in ('BMADVP','BMADVH','MEDGAP','MEDSEL','TIP','CBLU65')\n\tand rcst.prod_sh_nm not like '%DENT%'\n\tand e.MBR_ENR_CLS_PLN_PROD_CAT_CD = 'MED'\n\tand m.mbr_indv_be_key <> sp.mbr_indv_be_key\n\tand yr_mo.first_dt_of_mo > char(current date - 49 month, iso)\n\tand yr_mo.first_dt_of_mo < char(current date - 1 month, iso)\n\tand rcst.mbr_age_at_actvty_yr_mo >= 65","sessionInitStatement":null,"isolationLevel":null,"readFromSource":"sqlQuery","credentialScope":null,"secretUsername":[{"type":"pipelineConfiguration","value":["username_aka_alxaa2_Query_sel_2772"]}],"upperBound":null,"pushDownAggregate":null,"schema":{"type":"struct","fields":[{"name":"Household Member BE Key","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ACTVTY_YR_MO_SK","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"Member Product","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"Member BE Key","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"RETIREE_IN_HOUSEHOLD_IN","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"Household Member Prod","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"driver":"oracle.jdbc.driver.OracleDriver","createTableColumnTypes":null,"jdbcUrl":"","fetchsize":null,"dbtable":null,"componentInfo":{"gemId":"gitUri=http://gitserver:3000/yIytkCgB_team_4/yIytkCgB_project_11.git&subPath=&tag=0.2.24.dev3&projectSubscriptionProjectId=11&path=gems/jdbc","projectName":"ProphecySparkBasicsPython"},"principal":null,"textUsername":null,"createTableOptions":null,"secretJdbcUrl":[{"type":"pipelineConfiguration","value":["jdbcUrl_aka_alxaa2_Query_sel_2772"]}],"queryTimeout":null,"numPartitions":null,"datasetType":"Warehouse","credType":""}