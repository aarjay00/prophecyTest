{"textPassword":null,"refreshKrb5Config":null,"keytab":null,"format":"jdbc","cascadeTruncate":null,"secretPassword":[{"type":"pipelineConfiguration","value":["password_aka_alxaa2_Query_wit_2894"]}],"lowerBound":null,"writeMode":"read","description":"","preSQL":"","customSchema":null,"postSQL":"","partitionColumn":null,"pushDownPredicate":true,"truncate":null,"batchsize":null,"query":"with addresses as --Select unique complete line addresses for a member, including any address registered under this member \n(\n\tselect distinct\n\t\tm.mbr_home_addr_ln_1 || m.mbr_home_addr_ln_2 || m.mbr_home_addr_cnty_nm as addr_complete,\n\t\tm.mbr_home_addr_ln_1 || ' ' || m.mbr_home_addr_cnty_nm || ' ' || m.mbr_home_addr_city_nm || ' ' || m.mbr_home_addr_st_cd as addr_complete_apt_fixed,\n\t\tm.mbr_indv_be_key,\n\t\tm.mbr_sk\n\n\tfrom\n\t\tprod.mbr_d m\n\n\twhere\n\t\tm.mbr_indv_be_key != 0\n),\n\nmembers_per_address as -- Grouping by each address and the date associated within BlueKC for the address, count the number of members living there\n(\n\tselect\n\t\ta.addr_complete,\n\t\ta.addr_complete_apt_fixed,\n\t\tyr_mo.first_dt_of_mo,\n\t\tcount( distinct m.mbr_indv_be_key) as residents\n\n\tfrom\n\t\taddresses a\n\t\tinner join\n\t\t\tprod.mbr_d m on m.mbr_indv_be_key = a.mbr_indv_be_key and m.mbr_sk = a.mbr_sk\n\t\tinner join\n\t\t\tprod.mbr_rcst_ct_f rcst on rcst.mbr_sk = a.mbr_sk\n\t\tinner join\n\t\t\tprod.yr_mo_d yr_mo on yr_mo.yr_mo_sk = rcst.actvty_yr_mo_sk\n\n\twhere\n\t\tyr_mo.first_dt_of_mo >= char(current date - 49 month, iso)\n\t\tand yr_mo.first_dt_of_mo <= char(current date -1 month, iso)\n\n\tgroup by\n\t\ta.addr_complete,\n\t\ta.addr_complete_apt_fixed,\n\t\tyr_mo.first_dt_of_mo\n)\n\nselect\n\ta.mbr_indv_be_key,\n\ta.mbr_sk,\n\tmpa.first_dt_of_mo,\n\tmpa.residents,\n\ta.addr_complete_apt_fixed\n\nfrom\n\taddresses a\n\tinner join\n\t\tmembers_per_address mpa on mpa.addr_complete = a.addr_complete\n\nwhere\n\tmpa.residents <= 12","sessionInitStatement":null,"isolationLevel":null,"readFromSource":"sqlQuery","credentialScope":null,"secretUsername":[{"type":"pipelineConfiguration","value":["username_aka_alxaa2_Query_wit_2894"]}],"upperBound":null,"pushDownAggregate":null,"schema":{"type":"struct","fields":[{"name":"MBR_INDV_BE_KEY","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"MBR_SK","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ADDR_COMPLETE_APT_FIXED","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"RESIDENTS","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"FIRST_DT_OF_MO","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"driver":"oracle.jdbc.driver.OracleDriver","createTableColumnTypes":null,"jdbcUrl":"","fetchsize":null,"dbtable":null,"componentInfo":{"gemId":"gitUri=http://gitserver:3000/yIytkCgB_team_4/yIytkCgB_project_11.git&subPath=&tag=0.2.24.dev3&projectSubscriptionProjectId=11&path=gems/jdbc","projectName":"ProphecySparkBasicsPython"},"principal":null,"textUsername":null,"createTableOptions":null,"secretJdbcUrl":[{"type":"pipelineConfiguration","value":["jdbcUrl_aka_alxaa2_Query_wit_2894"]}],"queryTimeout":null,"numPartitions":null,"datasetType":"Warehouse","credType":""}