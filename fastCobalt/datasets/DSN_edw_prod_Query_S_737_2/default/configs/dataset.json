{"textPassword":null,"refreshKrb5Config":null,"keytab":null,"format":"jdbc","cascadeTruncate":null,"secretPassword":[{"type":"pipelineConfiguration","value":["password_DSN_edw_prod_Query_S_737"]}],"lowerBound":null,"writeMode":"read","description":"","preSQL":"","customSchema":null,"postSQL":"","partitionColumn":null,"pushDownPredicate":true,"truncate":null,"batchsize":null,"query":"SELECT PROD.MBR_D.MBR_INDV_BE_KEY, LEFT(PROD.CLM_F.CLM_PD_DT_SK, 7) as YEARMONTH,\n                                PROD.NDC_D.NDC_SK as PRI_NDC_SK,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPROD.NDC_D.NDC_BRND_NM as PRI_NDC_BRND_NM,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSUM(CLM_LN_TOT_PAYBL_AMT) as NDC_Cost,\n                                row_number() Over (Partition By PROD.MBR_D.MBR_INDV_BE_KEY, LEFT(PROD.CLM_F.CLM_PD_DT_SK, 7) Order By SUM(CLM_LN_TOT_PAYBL_AMT) DESC) row_no,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPROD.NDC_D.NDC  \n                FROM PROD.CLM_F\n                                JOIN PROD.MBR_D ON PROD.MBR_D.MBR_SK = PROD.CLM_F.MBR_SK\n                                JOIN PROD.NDC_D ON PROD.CLM_F.NDC_SK = PROD.NDC_D.NDC_SK\n                WHERE PROD.CLM_F.SRC_SYS_CD IN ('OPTUMRX','ESI','CVS','SAVRX') AND\n                                CLM_FINL_DISP_CD = 'ACPTD' AND\n                                PROD.CLM_F.CLM_STTUS_CD IN ('A02','A08','A09') AND\n                                CLM_TYP_CD = 'MED' AND\n                                CLM_CAT_CD = 'STD' --AND\n                               -- PROD.MBR_D.MBR_SK = '-2123739906' --'-2110003661' --'-1981535244'\n                                 AND\n                                (PROD.CLM_F.CLM_PD_DT_SK >= char (current date - day(current date) days +1 day - 60 months, ISO) OR (PROD.CLM_F.SRC_SYS_CD = 'OPTUMRX' AND PROD.CLM_F.CLM_PD_DT_SK = '1753-01-01'))        \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAND PROD.CLM_F.CLM_PD_DT_SK <= char (current date - day(current date) days +1 day - 13 months, ISO)                                                                                         \n                GROUP BY PROD.MBR_D.MBR_INDV_BE_KEY, LEFT(PROD.CLM_F.CLM_PD_DT_SK, 7),\n                                PROD.NDC_D.NDC_SK, PROD.NDC_D.NDC_BRND_NM, PROD.NDC_D.NDC ","sessionInitStatement":null,"isolationLevel":null,"readFromSource":"sqlQuery","credentialScope":null,"secretUsername":[{"type":"pipelineConfiguration","value":["username_DSN_edw_prod_Query_S_737"]}],"upperBound":null,"pushDownAggregate":null,"schema":{"type":"struct","fields":[{"name":"YEARMONTH","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"MBR_INDV_BE_KEY","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"MBR_SK","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"NDC","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"NDC_COST","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"DIAG_CD_DESC","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ROW_NO","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"PRI_NDC_BRND_NM","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"PRI_NDC_SK","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"driver":"oracle.jdbc.driver.OracleDriver","createTableColumnTypes":null,"jdbcUrl":"","fetchsize":null,"dbtable":null,"componentInfo":{"gemId":"gitUri=http://gitserver:3000/yIytkCgB_team_4/yIytkCgB_project_11.git&subPath=&tag=0.2.24.dev3&projectSubscriptionProjectId=11&path=gems/jdbc","projectName":"ProphecySparkBasicsPython"},"principal":null,"textUsername":null,"createTableOptions":null,"secretJdbcUrl":[{"type":"pipelineConfiguration","value":["jdbcUrl_DSN_edw_prod_Query_S_737"]}],"queryTimeout":null,"numPartitions":null,"datasetType":"Warehouse","credType":""}