{"textPassword":null,"refreshKrb5Config":null,"keytab":null,"format":"jdbc","cascadeTruncate":null,"secretPassword":[{"type":"pipelineConfiguration","value":["password_aka_alxaa2_Query_wit"]}],"lowerBound":null,"writeMode":"read","description":"","preSQL":"","customSchema":null,"postSQL":"","partitionColumn":null,"pushDownPredicate":true,"truncate":null,"batchsize":null,"query":"with filtered_members as \n(\n\tSelect distinct\n\t\tm.mbr_indv_be_key,\n\t\tm.mbr_sk,\n\t\trcst.grp_id,\n\t\tmax(rcst.actvty_yr_mo_sk) as last_membermonth\n\n\tFROM \n\t\tprod.mbr_d m\n\t\tinner join\n\t\t\tprod.mbr_rcst_ct_f rcst on rcst.mbr_sk = m.mbr_sk\n\n\tWHERE\n\t\trcst.actvty_yr_mo_sk > 201809\n\t\tand rcst.orig_exprnc_cat_cd != 'FEP'\n\t\tand rcst.mbr_age_at_actvty_yr_mo >= 63\n\n\tgroup by\n\t\tm.mbr_indv_be_key,\n\t\tm.mbr_sk,\n\t\trcst.grp_id\n),\n\nformated_members as \n(\n\tselect distinct\n\t\tfm.mbr_indv_be_key,\n\t\tmax(fm.last_membermonth) as max_month\n\n\tfrom\n\t\tfiltered_members fm\n\n\tgroup by\n\t\tfm.mbr_indv_be_key\n)\n\nselect \n\tfom.mbr_indv_be_key,\n\tfim.mbr_sk,\n\tfim.grp_id,\n\trcst.actvty_yr_mo_sk\n\nfrom\n\tformated_members fom\n\tinner join\n\t\tfiltered_members fim on fim.mbr_indv_be_key = fom.mbr_indv_be_key and fim.last_membermonth = fom.max_month\n\tinner join\n\t\tprod.mbr_rcst_ct_f rcst on rcst.mbr_sk = fim.mbr_sk","sessionInitStatement":null,"isolationLevel":null,"readFromSource":"sqlQuery","credentialScope":null,"secretUsername":[{"type":"pipelineConfiguration","value":["username_aka_alxaa2_Query_wit"]}],"upperBound":null,"pushDownAggregate":null,"schema":{"type":"struct","fields":[{"name":"MBR_INDV_BE_KEY","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"MBR_SK","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"GRP_ID","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ACTVTY_YR_MO_SK","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"driver":"oracle.jdbc.driver.OracleDriver","createTableColumnTypes":null,"jdbcUrl":"","fetchsize":null,"dbtable":null,"componentInfo":{"gemId":"gitUri=http://gitserver:3000/yIytkCgB_team_4/yIytkCgB_project_11.git&subPath=&tag=0.2.24.dev3&projectSubscriptionProjectId=11&path=gems/jdbc","projectName":"ProphecySparkBasicsPython"},"principal":null,"textUsername":null,"createTableOptions":null,"secretJdbcUrl":[{"type":"pipelineConfiguration","value":["jdbcUrl_aka_alxaa2_Query_wit"]}],"queryTimeout":null,"numPartitions":null,"datasetType":"Warehouse","credType":""}