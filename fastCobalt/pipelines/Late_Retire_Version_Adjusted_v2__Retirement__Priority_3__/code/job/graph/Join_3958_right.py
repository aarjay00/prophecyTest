from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from prophecy.utils import *
from prophecy.libs import typed_lit
from job.config.ConfigStore import *
from job.udfs.UDFs import *

def Join_3958_right(spark: SparkSession, in0: DataFrame, in1: DataFrame, ) -> DataFrame:
    return in0\
        .alias("in0")\
        .join(in1.alias("in1"), (col("in1.MBR_INDV_BE_KEY") == col("in0.MBR_INDV_BE_KEY")), "leftanti")\
        .select(col("in0.`Generic Drug Counts`").alias("Generic Drug Counts"), col("in0.BCARE").alias("BCARE"), col("in0.`Distinct Diagnosis Types`").alias("Distinct Diagnosis Types"), col("in0.HOST_MBR_IN").alias("HOST_MBR_IN"), col("in0.`Average Age Females`").alias("Average Age Females"), col("in0.`Dental ALCOHOL_DRUG_USE_AND_DISORDERS`").alias("Dental ALCOHOL_DRUG_USE_AND_DISORDERS"), col("in0.`Specialty Drug Counts`").alias("Specialty Drug Counts"), col("in0.`Spouse Retired`").alias("Spouse Retired"), col("in0.Inpatient").alias("Inpatient"), col("in0.`Medical MYELOPROLIFERATIVE_AND_NEOPLASMS`").alias("Medical MYELOPROLIFERATIVE_AND_NEOPLASMS"), col("in0.PCBEXTRNL").alias("PCBEXTRNL"), col("in0.PRNT_GRP_SIC_NACIS_CD").alias("PRNT_GRP_SIC_NACIS_CD"), col("in0.`Apt Ind`").alias("Apt Ind"), col("in0.SPIRA_BNF_ID").alias("SPIRA_BNF_ID"), col("in0.`Min_Dependent Age`").alias("Min_Dependent Age"), col("in0.`Medical INFECTIOUS_AND_PARASITIC_DISEASES`").alias("Medical INFECTIOUS_AND_PARASITIC_DISEASES"), col("in0.`Medical KIDNEY_AND_URINARY_TRACT`").alias("Medical KIDNEY_AND_URINARY_TRACT"), col("in0.`Medical ALCOHOL_DRUG_USE_AND_DISORDERS`").alias("Medical ALCOHOL_DRUG_USE_AND_DISORDERS"), col("in0.`Dental MENTAL_ILLNESS`").alias("Dental MENTAL_ILLNESS"), col("in0.GRP_ZIP_CD_5").alias("GRP_ZIP_CD_5"), col("in0.BLUE_SELECT").alias("BLUE_SELECT"), col("in0.`Vision Member Pay`").alias("Vision Member Pay"), col("in0.`Medical RESPIRATORY_SYSTEM`").alias("Medical RESPIRATORY_SYSTEM"), col("in0.`Medical FACTORS_INFLUENCING_HEALTH_STATUS`").alias("Medical FACTORS_INFLUENCING_HEALTH_STATUS"), col("in0.MBR_DSBLTY_IN").alias("MBR_DSBLTY_IN"), col("in0.`Average Age Males`").alias("Average Age Males"), col("in0.`Female Percentage`").alias("Female Percentage"), col("in0.`Medical BURNS`").alias("Medical BURNS"), col("in0.`Member Months`").alias("Member Months"), col("in0.`Male Percentage`").alias("Male Percentage"), col("in0.`Medical MUSCULOSKETAL_SYSTEM`").alias("Medical MUSCULOSKETAL_SYSTEM"), col("in0.MBR_RELSHP_NM").alias("MBR_RELSHP_NM"), col("in0.MBR_HOME_ADDR_ZIP_CD_5").alias("MBR_HOME_ADDR_ZIP_CD_5"), col("in0.CLS_PLN_DESC").alias("CLS_PLN_DESC"), col("in0.`Group Months`").alias("Group Months"), col("in0.`Retired With Blue`").alias("Retired With Blue"), col("in0.AGE").alias("AGE"), col("in0.YMD").alias("YMD"), col("in0.MBR_INDV_BE_KEY").alias("MBR_INDV_BE_KEY"), col("in0.`Mail Order Drug Counts`").alias("Mail Order Drug Counts"), col("in0.`RX Member Pay`").alias("RX Member Pay"), col("in0.`Depression Related Claims`").alias("Depression Related Claims"), col("in0.`Dental Member Pay`").alias("Dental Member Pay"), col("in0.GRP_ID").alias("GRP_ID"), col("in0.`Drug Tier 1`").alias("Drug Tier 1"), col("in0.SUB_MBR_SK").alias("SUB_MBR_SK"), col("in0.SUM_CCI").alias("SUM_CCI"), col("in0.`Distinct NDC Codes`").alias("Distinct NDC Codes"), col("in0.`Medical DIGESTIVE_SYSTEM`").alias("Medical DIGESTIVE_SYSTEM"), col("in0.PC").alias("PC"), col("in0.`Drug Tier 2`").alias("Drug Tier 2"), col("in0.Outpatient").alias("Outpatient"), col("in0.`Medical FEMALE_REPRODUCTIVE_SYSTEM`").alias("Medical FEMALE_REPRODUCTIVE_SYSTEM"), col("in0.`Medical CIRCULATORY_SYSTEM`").alias("Medical CIRCULATORY_SYSTEM"), col("in0.FNCL_LOB_CD").alias("FNCL_LOB_CD"), col("in0.`Target Forecasted`").alias("Target Forecasted"), col("in0.GRP_MKT_SIZE_CAT_NM").alias("GRP_MKT_SIZE_CAT_NM"), col("in0.`Medical PREGNANCY__CHILDBIRTH_AND_PUERPERIUM`")\
        .alias("Medical PREGNANCY__CHILDBIRTH_AND_PUERPERIUM"), col("in0.`Product Category`").alias("Product Category"), col("in0.`High Deductible Ind`").alias("High Deductible Ind"), col("in0.`Medical INJURIES__POISONINGS_AND_DRUG_EFFECTS`")\
        .alias("Medical INJURIES__POISONINGS_AND_DRUG_EFFECTS"), col("in0.`Medical MENTAL_ILLNESS`").alias("Medical MENTAL_ILLNESS"), col("in0.`Dental FACTORS_INFLUENCING_HEALTH_STATUS`").alias("Dental FACTORS_INFLUENCING_HEALTH_STATUS"), col("in0.BLUE_ACCESS").alias("BLUE_ACCESS"), col("in0.`Medical HEPATOBILARY_SYSTEM`").alias("Medical HEPATOBILARY_SYSTEM"), col("in0.MBR_GNDR_CD").alias("MBR_GNDR_CD"), col("in0.MBR_HOME_ADDR_ST_CD").alias("MBR_HOME_ADDR_ST_CD"), col("in0.`Spouse Age`").alias("Spouse Age"), col("in0.Emergency_Room").alias("Emergency_Room"), col("in0.`Drug Tier 3`").alias("Drug Tier 3"), col("in0.Members_on_Policy").alias("Members_on_Policy"), col("in0.`Medical MALE_REPRODUCTIVE_SYSTEM`").alias("Medical MALE_REPRODUCTIVE_SYSTEM"), col("in0.MBR_ENR_COBRA_IN").alias("MBR_ENR_COBRA_IN"), col("in0.`Vision EYE`").alias("Vision EYE"), col("in0.`Med Member Pay`").alias("Med Member Pay"), col("in0.YEARMONTH").alias("YEARMONTH"), col("in0.`Dental SKIN_SUBCUTANEOUS_TISSUE_AND_BREAST`").alias("Dental SKIN_SUBCUTANEOUS_TISSUE_AND_BREAST"), col("in0.GRP_TOT_EMPL_CT").alias("GRP_TOT_EMPL_CT"), col("in0.`Vision ENDOCRINE__NUTRITIONAL_AND_METABOLIC`").alias("Vision ENDOCRINE__NUTRITIONAL_AND_METABOLIC"), col("in0.`Dental EAR__NOSE__AND_THROAT`").alias("Dental EAR__NOSE__AND_THROAT"), col("in0.`Medical AIDS_HIV`").alias("Medical AIDS_HIV"), col("in0.`Dental Dental Member Pay`").alias("Dental Dental Member Pay"), col("in0.`Medical ENDOCRINE__NUTRITIONAL_AND_METABOLIC`")\
        .alias("Medical ENDOCRINE__NUTRITIONAL_AND_METABOLIC"), col("in0.`Medical SKIN_SUBCUTANEOUS_TISSUE_AND_BREAST`").alias("Medical SKIN_SUBCUTANEOUS_TISSUE_AND_BREAST"), col("in0.PCP_FLAG").alias("PCP_FLAG"), col("in0.`Medical EAR__NOSE__AND_THROAT`").alias("Medical EAR__NOSE__AND_THROAT"), col("in0.`Medical BLOOD_AND_BLOOD_FORMING_ORGANS`").alias("Medical BLOOD_AND_BLOOD_FORMING_ORGANS"), col("in0.`Medical EYE`").alias("Medical EYE"), col("in0.`Vision FACTORS_INFLUENCING_HEALTH_STATUS`").alias("Vision FACTORS_INFLUENCING_HEALTH_STATUS"), col("in0.PCB").alias("PCB"), col("in0.`Number of Winterizing Procedures`").alias("Number of Winterizing Procedures"), col("in0.`Medical NEWBORNS_AND_OTHER_NEONATES`").alias("Medical NEWBORNS_AND_OTHER_NEONATES"), col("in0.BLUESELECT_").alias("BLUESELECT_"), col("in0.EXPRNC_CAT_CD").alias("EXPRNC_CAT_CD"), col("in0.`Medical NERVOUS_SYSTEM`").alias("Medical NERVOUS_SYSTEM"))
