from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from job.config.ConfigStore import *
from job.udfs.UDFs import *
from prophecy.utils import *
from job.graph import *

def pipeline(spark: SparkSession) -> None:
    df_TextInput_173 = TextInput_173(spark)
    df_Summarize_174 = Summarize_174(spark, df_TextInput_173)
    df_AppendFields_175 = AppendFields_175(spark, df_TextInput_173, df_Summarize_174)
    df_Formula_176 = Formula_176(spark, df_AppendFields_175)
    df_AlteryxSelect_177 = AlteryxSelect_177(spark, df_Formula_176)
    df_Dates_xlsx_Query__Sh = Dates_xlsx_Query__Sh(spark)
    df_Filter_40 = Filter_40(spark, df_Dates_xlsx_Query__Sh)
    df_AlteryxSelect_39 = AlteryxSelect_39(spark, df_Filter_40)
    df_AlteryxSelect_198 = AlteryxSelect_198(spark, df_AlteryxSelect_39)
    df_Formula_199 = Formula_199(spark, df_AlteryxSelect_198)
    df_Filter_200 = Filter_200(spark, df_Formula_199)
    df_AppendFields_202 = AppendFields_202(spark, df_Filter_200, df_AlteryxSelect_177)
    df_AlteryxSelect_205 = AlteryxSelect_205(spark, df_AppendFields_202)
    df_2024q2_az_prov_csv = 2024q2_az_prov_csv(spark)
    df_AlteryxSelect_47 = AlteryxSelect_47(spark, df_2024q2_az_prov_csv)
    df_Formula_46 = Formula_46(spark, df_AlteryxSelect_47)
    df_Filter_45 = Filter_45(spark, df_Formula_46)
    df_ProdIDCrossWalk_xlsx = ProdIDCrossWalk_xlsx(spark)
    df_Sort_4 = Sort_4(spark, df_ProdIDCrossWalk_xlsx)
    df_Unique_5 = Unique_5(spark, df_Sort_4)
    df_AlteryxSelect_3 = AlteryxSelect_3(spark, df_Unique_5)
    df_OARSPCTICDATA2021_20 = OARSPCTICDATA2021_20(spark)
    df_OARSPCTICDATA2024Q1_ = OARSPCTICDATA2024Q1_(spark)
    df_Union_223 = Union_223(spark, df_OARSPCTICDATA2021_20, df_OARSPCTICDATA2024Q1_)
    df_TextToColumns_23 = TextToColumns_23(spark, df_Union_223)
    df_Formula_21 = Formula_21(spark, df_TextToColumns_23)
    df_AlteryxSelect_24 = AlteryxSelect_24(spark, df_Formula_21)
    df_Join_41_right_UnionRightOuter = Join_41_right_UnionRightOuter(spark, df_AlteryxSelect_24, df_AlteryxSelect_39)
    df_Filter_25 = Filter_25(spark, df_Join_41_right_UnionRightOuter)
    df_Summarize_6 = Summarize_6(spark, df_Filter_25)
    df_Sort_7 = Sort_7(spark, df_Summarize_6)
    df_Join_9_inner = Join_9_inner(spark, df_Sort_7, df_AlteryxSelect_3)
    df_Filter_8 = Filter_8(spark, df_Join_9_inner)
    df_Unique_44 = Unique_44(spark, df_Filter_8)
    df_Formula_11 = Formula_11(spark, df_Unique_44)
    df_Summarize_12 = Summarize_12(spark, df_Formula_11)
    df_Sort_13 = Sort_13(spark, df_Summarize_12)
    df_Summarize_16 = Summarize_16(spark, df_Sort_13)
    df_Join_17_inner = Join_17_inner(spark, df_Sort_13, df_Summarize_16)
    df_Formula_18 = Formula_18(spark, df_Join_17_inner)
    df_Sort_19 = Sort_19(spark, df_Formula_18)
    df_Sort_30 = Sort_30(spark, df_Sort_19)
    df_Filter_37 = Filter_37(spark, df_Sort_30)
    df_Formula_32 = Formula_32(spark, df_Filter_37)
    df_MultiRowFormula_31_window = MultiRowFormula_31_window(spark, df_Formula_32)
    df_MultiRowFormula_31 = MultiRowFormula_31(spark, df_MultiRowFormula_31_window)
    df_Sort_35 = Sort_35(spark, df_MultiRowFormula_31)
    df_MultiRowFormula_36_window = MultiRowFormula_36_window(spark, df_Sort_35)
    df_MultiRowFormula_36 = MultiRowFormula_36(spark, df_MultiRowFormula_36_window)
    df_Filter_33 = Filter_33(spark, df_MultiRowFormula_36)
    df_AppendFields_34 = AppendFields_34(spark, df_Filter_33, df_Filter_45)
    df_Filter_64 = Filter_64(spark, df_Join_9_inner)
    df_Summarize_65 = Summarize_65(spark, df_Filter_64)
    df_Summarize_66 = Summarize_66(spark, df_Filter_8)
    df_Union_67 = Union_67(spark, df_Summarize_65, df_Summarize_66)
    df_ProdIDCrossWalk_xlsx_73 = ProdIDCrossWalk_xlsx_73(spark)
    df_Sort_75 = Sort_75(spark, df_ProdIDCrossWalk_xlsx_73)
    df_Unique_76 = Unique_76(spark, df_Sort_75)
    df_AlteryxSelect_74 = AlteryxSelect_74(spark, df_Unique_76)
    df_Filter_91 = Filter_91(spark, df_Join_41_right_UnionRightOuter)
    df_Summarize_77 = Summarize_77(spark, df_Filter_91)
    df_Sort_78 = Sort_78(spark, df_Summarize_77)
    df_Join_80_inner = Join_80_inner(spark, df_Sort_78, df_AlteryxSelect_74)
    df_Filter_116 = Filter_116(spark, df_Join_80_inner)
    df_Summarize_117 = Summarize_117(spark, df_Filter_116)
    df_Filter_79 = Filter_79(spark, df_Join_80_inner)
    df_Summarize_118 = Summarize_118(spark, df_Filter_79)
    df_Union_119 = Union_119(spark, df_Summarize_117, df_Summarize_118)
    df_Summarize_120 = Summarize_120(spark, df_Union_119)
    df_2024q2_kc_prov_csv = 2024q2_kc_prov_csv(spark)
    df_AlteryxSelect_185 = AlteryxSelect_185(spark, df_2024q2_kc_prov_csv)
    df_Formula_184 = Formula_184(spark, df_AlteryxSelect_185)
    df_Filter_183 = Filter_183(spark, df_Formula_184)
    df_Summarize_192 = Summarize_192(spark, df_Filter_183)
    df_Formula_193 = Formula_193(spark, df_Summarize_192)
    df_Filter_196 = Filter_196(spark, df_Filter_79)
    df_Unique_100 = Unique_100(spark, df_Filter_196)
    df_Summarize_139 = Summarize_139(spark, df_Unique_100)
    df_Sort_140 = Sort_140(spark, df_Summarize_139)
    df_Summarize_141 = Summarize_141(spark, df_Sort_140)
    df_Join_142_inner = Join_142_inner(spark, df_Sort_140, df_Summarize_141)
    df_Formula_143 = Formula_143(spark, df_Join_142_inner)
    df_Sort_144 = Sort_144(spark, df_Formula_143)
    df_Sort_145 = Sort_145(spark, df_Sort_144)
    df_Filter_152 = Filter_152(spark, df_Sort_145)
    df_Formula_147 = Formula_147(spark, df_Filter_152)
    df_MultiRowFormula_180 = MultiRowFormula_180(spark, df_Formula_147)
    df_Filter_181 = Filter_181(spark, df_MultiRowFormula_180)
    df_AppendFields_182 = AppendFields_182(spark, df_Filter_181, df_Filter_183)
    df_TextInput_128 = TextInput_128(spark)
    df_Summarize_129 = Summarize_129(spark, df_TextInput_128)
    df_AppendFields_131 = AppendFields_131(spark, df_TextInput_128, df_Summarize_129)
    df_Formula_132 = Formula_132(spark, df_AppendFields_131)
    df_AlteryxSelect_133 = AlteryxSelect_133(spark, df_Formula_132)
    df_Formula_48 = Formula_48(spark, df_AppendFields_34)
    df_Sort_49 = Sort_49(spark, df_Formula_48)
    df_AlteryxSelect_50 = AlteryxSelect_50(spark, df_Sort_49)
    df_Summarize_51 = Summarize_51(spark, df_AlteryxSelect_50)
    df_Sort_52 = Sort_52(spark, df_Summarize_51)
    df_AlteryxSelect_54 = AlteryxSelect_54(spark, df_Sort_52)
    df_Summarize_57 = Summarize_57(spark, df_Filter_45)
    df_Formula_58 = Formula_58(spark, df_Summarize_57)
    df_Join_59_inner = Join_59_inner(spark, df_AlteryxSelect_54, df_Formula_58)
    df_AppendFields_134 = AppendFields_134(spark, df_Join_59_inner, df_AlteryxSelect_133)
    df_AlteryxSelect_136 = AlteryxSelect_136(spark, df_AppendFields_134)
    df_Sort_135 = Sort_135(spark, df_AlteryxSelect_136)
    df_Formula_137 = Formula_137(spark, df_Sort_135)
    df_AlteryxSelect_61 = AlteryxSelect_61(spark, df_Formula_137)
    df_Sort_125 = Sort_125(spark, df_AlteryxSelect_61)
    df_Sample_218 = Sample_218(spark, df_Sort_125)
    df_Sample_218_filter = Sample_218_filter(spark, df_Sample_218)
    df_AlteryxSelect_210 = AlteryxSelect_210(spark, df_AlteryxSelect_39)
    df_Formula_211 = Formula_211(spark, df_AlteryxSelect_210)
    df_Filter_212 = Filter_212(spark, df_Formula_211)
    df_AppendFields_213 = AppendFields_213(spark, df_Filter_212, df_AlteryxSelect_133)
    df_AlteryxSelect_215 = AlteryxSelect_215(spark, df_AppendFields_213)
    df_Union_214_reformat_0 = Union_214_reformat_0(spark, df_AlteryxSelect_215)
    df_Union_214_reformat_1 = Union_214_reformat_1(spark, df_Sample_218_filter)
    df_Union_214 = Union_214(spark, df_Union_214_reformat_0, df_Union_214_reformat_1)
    df_Filter_217 = Filter_217(spark, df_Union_214)
    df_MultiFieldFormula_216 = MultiFieldFormula_216(spark, df_Filter_217)
    df_Formula_186 = Formula_186(spark, df_AppendFields_182)
    df_Sort_187 = Sort_187(spark, df_Formula_186)
    df_AlteryxSelect_188 = AlteryxSelect_188(spark, df_Sort_187)
    df_Summarize_189 = Summarize_189(spark, df_AlteryxSelect_188)
    df_Sort_190 = Sort_190(spark, df_Summarize_189)
    df_AlteryxSelect_191 = AlteryxSelect_191(spark, df_Sort_190)
    df_Join_195_inner = Join_195_inner(spark, df_AlteryxSelect_191, df_Formula_193)
    df_AppendFields_163 = AppendFields_163(spark, df_Join_195_inner, df_AlteryxSelect_177)
    df_AlteryxSelect_165 = AlteryxSelect_165(spark, df_AppendFields_163)
    df_Sort_164 = Sort_164(spark, df_AlteryxSelect_165)
    df_Formula_166 = Formula_166(spark, df_Sort_164)
    df_AlteryxSelect_160 = AlteryxSelect_160(spark, df_Formula_166)
    df_Sort_161 = Sort_161(spark, df_AlteryxSelect_160)
    df_Sample_204 = Sample_204(spark, df_Sort_161)
    df_Sample_204_filter = Sample_204_filter(spark, df_Sample_204)
    df_Summarize_14 = Summarize_14(spark, df_Summarize_12)
    df_Formula_15 = Formula_15(spark, df_Summarize_14)
    df_Join_121_inner = Join_121_inner(spark, df_Summarize_120, df_Summarize_117)
    df_Formula_122 = Formula_122(spark, df_Join_121_inner)
    df_Sort_123 = Sort_123(spark, df_Formula_122)
    df_Summarize_68 = Summarize_68(spark, df_Union_67)
    df_Union_203_reformat_0 = Union_203_reformat_0(spark, df_AlteryxSelect_205)
    df_Union_203_reformat_1 = Union_203_reformat_1(spark, df_Sample_204_filter)
    df_Union_203 = Union_203(spark, df_Union_203_reformat_1, df_Union_203_reformat_0)
    df_Filter_209 = Filter_209(spark, df_Union_203)
    df_MultiFieldFormula_206 = MultiFieldFormula_206(spark, df_Filter_209)
    df_Join_69_inner = Join_69_inner(spark, df_Summarize_68, df_Summarize_65)
    df_Formula_70 = Formula_70(spark, df_Join_69_inner)
    df_Sort_71 = Sort_71(spark, df_Formula_70)
    df_Union_220 = Union_220(spark, df_Sort_125, df_MultiFieldFormula_216)
    df_Sort_219 = Sort_219(spark, df_Union_220)
    df_Union_207 = Union_207(spark, df_Sort_161, df_MultiFieldFormula_206)
    df_Sort_208 = Sort_208(spark, df_Union_207)
    Mock_Output2_xlsx_Qu(spark, df_Sort_219)
    Mock_Output2_xlsx_Qu_109(spark, df_Sort_208)

def main():
    spark = SparkSession.builder\
                .config("spark.default.parallelism", "4")\
                .config("spark.sql.legacy.allowUntypedScalaUDF", "true")\
                .enableHiveSupport()\
                .appName("Prophecy Pipeline")\
                .getOrCreate()
    Utils.initializeFromArgs(spark, parse_args())
    spark.conf.set("prophecy.metadata.pipeline.uri", "pipelines/File_generationV2__")
    registerUDFs(spark)
    
    MetricsCollector.instrument(spark = spark, pipelineId = "pipelines/File_generationV2__", config = Config)(pipeline)

if __name__ == "__main__":
    main()
