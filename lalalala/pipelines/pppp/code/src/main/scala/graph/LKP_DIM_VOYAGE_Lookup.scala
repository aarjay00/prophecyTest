package graph

import io.prophecy.libs._
import config.Context
import udfs.UDFs._
import org.apache.spark._
import org.apache.spark.sql._
import org.apache.spark.sql.functions._
import org.apache.spark.sql.types._
import org.apache.spark.sql.expressions._
import java.time._

object LKP_DIM_VOYAGE_Lookup {

  def apply(context: Context, in: DataFrame): Unit =
    createLookup(
      "LKP_DIM_VOYAGE_Lookup",
      in,
      context.spark,
      List("in_SHIP_CODE", "in_SHIP_DEPARTURE_DATE"),
      "VOYAGE_SK",
      "SHIP_DEPARTURE_DATE",
      "COUNT_REPORT_SHIP_CODE",
      "SHIP_CODE",
      "PRIOR_YEAR_SHIP_CODE",
      "GEOGRAPHIC_REGION_CODE",
      "GEOGRAPHIC_REGION_REFNC_CODE",
      "ACTIVE_STATUS_CODE",
      "SHIP_PROFILE_DESC",
      "COMMISSION_PROC_FOR_SAIL_FLAG",
      "AUTO_UPGR_ELIG_FROM_CATG_CODE",
      "GEOGRAPHIC_AREA_NAME",
      "AUTO_UPGR_ELIG_TO_CATG_CODE",
      "GEOGRAPHIC_AREA_SAIL_PERD_TEXT",
      "VOYAGE_BALANCING_DATE",
      "GEOGRAPHIC_AREA_TEXT",
      "VOYAGE_TERMINATION_DATE",
      "PAYMENT_SCHEDULE_CODE",
      "PAYMENT_SCHEUDLE_DESC",
      "VOYAGE_LONG_COMMENT_TEXT",
      "VOYAGE_CRS_DEPARTURE_DATE_TEXT",
      "VOYAGE_RESERVATION_STATUS_CODE",
      "VOYAGE_RESERVATION_STATUS_DESC",
      "VOYAGE_DISPATCH_CODE",
      "PRIOR_YEAR_SAIL_DATE",
      "VOYAGE_NBR",
      "VOYAGE_YEAR_QUARTER_SAIL_DATE",
      "COUNT_REPORT_ITINERARY_CODE",
      "OPTION_EXTENTION_DAYS_QTY",
      "COUNT_REPORT_ITINERARY_DESC",
      "VOYAGE_COMMENT_TEXT",
      "ACCOUNTING_VOYAGE_NBR",
      "VOYAGE_GUEST_BOARDING_DATE",
      "VOYAGE_RETURN_DATE",
      "EXTEND_OPTION_FLAG_CRSMTCH_QTY",
      "ENCORE_ITINERARY_CODE",
      "VOYAGE_DISPATCH_DESC",
      "VOYAGE_EMBARKATION_TIME",
      "VOYAGE_SET_SAIL_TIME",
      "VOYAGE_EMBARKATION_HOUR_CODE",
      "VOYAGE_SET_SAIL_HOUR_CODE",
      "REGION_TRAVEL_AREA_DESC",
      "REGION_TRAVEL_AREA_CODE",
      "ITINERARY_DAYS_QTY",
      "VOYAGE_ORIGINATING_PORT_CODE",
      "VOYAGE_CHARTERED_FLAG",
      "VOYAGE_GG_DISCOUNT_AVL_FLAG",
      "VOYAGE_GG_DISCOUNT_PCT",
      "VOYAGE_GG_DISCOUNT_CLOSED_DATE",
      "VOYAGE_GG_DISCOUNT_REOPEN_DATE",
      "VOYAGE_UAP_PERCENT_DOLLAR_CODE",
      "VOYAGE_CRUISE_ONLY_UAP_AMT",
      "VOYAGE_AIR_SEA_UAP_AMT",
      "VOYAGE_UAP_DISCOUNT_EXTND_FLAG",
      "RESTRICT_INDIVDUAL_TRIPLE_FLAG",
      "RESTRICT_INDIVIDUAL_QUAD_FLAG",
      "RESTRICT_INDVD_SGLDBL_3_4_FLAG",
      "RESTRICT_GROUP_TRIPLE_FLAG",
      "RESTRICT_GROUP_QUAD_FLAG",
      "VOYAGE_REMARK_1_TEXT",
      "VOYAGE_REMARK_2_TEXT",
      "RESTRICT_GROUP_SGLDBL_3_4_FLAG",
      "EXPANDED_AMENITY_PROCESS_DTM",
      "EXPANDED_AMENITY_PROCESS_CODE",
      "VOYAGE_GRP_CABN_GROSS_TARG_QTY",
      "VOYAGE_GROUP_CABN_NET_TARG_QTY",
      "BATCH_STATUS_CODE",
      "BATCH_STATUS_DESC",
      "MONTH_NBR",
      "VOYAGE_BONUS_COMMISSION_FLAG",
      "VOYAGE_PAYSCH_EXCPN_FLAG",
      "BREAK_THROUGH_PROMOTION_2_CODE",
      "VOYAGE_ELIGIBLE_AUTO_UPGR_FLAG",
      "VOYAGE_REVENUE_SAILING_FLAG",
      "VOYAGE_DEPARTURE_JULIAN_DATE",
      "VOYAGE_DEPARTURE_YEAR_NBR",
      "VOYAGE_RECOGNIZE_EXPN_YEAR_NBR",
      "GROUP_OPTN_DAYS_OVRID_QTY",
      "GROUP_GTY_OPTN_OVRID_DAYS_QTY",
      "GROUP_CABN_OPTN_OVRID_DAYS_QTY",
      "VOYAGE_REVIEW_DATE",
      "RESTART_C_U_FOR_GROUPS_FLAG",
      "PENALTY_EXCEPTION_FROM_DATE",
      "PENALTY_EXCEPTION_TO_DATE",
      "GROUP_AMENITIES_PLIM_RUN_DTM",
      "AMENITY_CODE",
      "AMENITY_DESC",
      "AUTOBOOK_DAYS_START_QTY",
      "AUTOBOOK_DAYS_STOP_QTY",
      "PSEUDO_NAME_ADD_PRIOR_DAYS_QTY",
      "CHNG_CXL_MANL_MOD_PRIR_DAY_QTY",
      "OPTION_EXTEND_TIMES_QTY",
      "FINAL_OPTION_EXTNSN_DAYS_QTY",
      "AUTOMATED_PRODUCTS_LYL_PNT_QTY",
      "AUTO_BOOK_AVAILABLE_FLAG",
      "ITINERARY_CODE",
      "CRSMTCH_DSPL_LNG_CMNT_FLAG",
      "SHIP_PROFILE_ID",
      "ORIGINAL_SHIP_PROFILE_ID",
      "HOLD_DECK_LEGEND_CODE",
      "GROUP_OPTION_EXTEND_TIMES_QTY",
      "GROUP_OPTION_EXTEND_DAYS_QTY",
      "GAP_POINTS_QTY",
      "SRC_VOYAGE_UPSERT_DTM",
      "BOOK_MINIMUM_REQUIRED_AGE_CNT",
      "SRC_VOYAGE_UPSERT_USER_ID",
      "ORIGINAL_GAP_POINTS_QTY",
      "LAST_CHANGED_APPLICATION_ID",
      "VOYAGE_EXPEDITION_FLAG",
      "SHIP_CURRENCY_CODE",
      "PROCESS_CREATION_DTM",
      "PROCESS_CREATION_USER_ID",
      "PROCESS_LAST_UPDATE_DTM",
      "PROCESS_LAST_UPDATE_USER_ID",
      "BREAK_THROUGH_PROMOTION_CODE",
      "ITINERARY_VOYAGE_EFF_FROM_DATE",
      "EFFECTIVE_START_DATE",
      "EFFECTIVE_END_DATE",
      "CURRENT_FLAG",
      "CHECKSUM_NBR",
      "ACTIVE_STATUS_DESC",
      "VOYAGE_ORIGINATING_PORT_DESC",
      "OBS_RECEIVED_FLAG",
      "OBS_RECEIVED_DTM"
    )

}
